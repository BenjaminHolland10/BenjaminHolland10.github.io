<!DOCTYPE html>
<html>
<head>
    <title>Node</title>
    <script type="text/javascript" src="vivagraph.js"></script>
    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
    <script type="text/javascript">
        function main () {
             var stuff = [
   {
    "kind": "track",
    "id": 68401589,
    "created_at": "2012/11/22 10:39:55 +0000",
    "user_id": 2016749,
    "duration": 187053,
    "commentable": true,
    "state": "finished",
    "original_content_size": 7484521,
    "last_modified": "2013/10/31 14:40:22 +0000",
    "sharing": "public",
    "tag_list": "",
    "permalink": "count-me-out",
    "streamable": true,
    "embeddable_by": "all",
    "downloadable": false,
    "purchase_url": null,
    "label_id": null,
    "purchase_title": null,
    "genre": "Folk",
    "title": "Count me out",
    "description": "",
    "label_name": "",
    "release": "",
    "track_type": "original",
    "key_signature": "",
    "isrc": "",
    "video_url": null,
    "bpm": null,
    "release_year": null,
    "release_month": null,
    "release_day": null,
    "original_format": "mp3",
    "license": "all-rights-reserved",
    "uri": "https://api.soundcloud.com/tracks/68401589",
    "user":  {
      "id": 2016749,
      "kind": "user",
      "permalink": "mooders",
      "username": "mooders",
      "last_modified": "2014/11/25 15:27:44 +0000",
      "uri": "https://api.soundcloud.com/users/2016749",
      "permalink_url": "http://soundcloud.com/mooders",
      "avatar_url": "https://i1.sndcdn.com/avatars-000018130606-px3sia-large.jpg"
    },
    "permalink_url": "http://soundcloud.com/mooders/count-me-out",
    "artwork_url": null,
    "waveform_url": "https://w1.sndcdn.com/Z4WoFFIUNpj2_m.png",
    "stream_url": "https://api.soundcloud.com/tracks/68401589/stream",
    "playback_count": 2409,
    "download_count": 0,
    "favoritings_count": 73,
    "comment_count": 21,
    "attachments_uri": "https://api.soundcloud.com/tracks/68401589/attachments",
    "policy": "ALLOW"
  },
   {
    "kind": "track",
    "id": 12766372,
    "created_at": "2011/03/30 07:26:29 +0000",
    "user_id": 727717,
    "duration": 184207,
    "commentable": true,
    "state": "finished",
    "original_content_size": 7363478,
    "last_modified": "2015/02/11 22:22:20 +0000",
    "sharing": "public",
    "tag_list": "Post beat Hiphop Triphop Trubhop Midwess Midwest Cleveland Ohio Robb Fernald",
    "permalink": "phase-v-4-0",
    "streamable": true,
    "embeddable_by": "all",
    "downloadable": false,
    "purchase_url": null,
    "label_id": null,
    "purchase_title": null,
    "genre": "post future",
    "title": "Phase V",
    "description": "Post beat.",
    "label_name": "",
    "release": "",
    "track_type": "original",
    "key_signature": "",
    "isrc": "",
    "video_url": "http://www.youtube.com/watch?v=wtQJArkypkE",
    "bpm": null,
    "release_year": null,
    "release_month": null,
    "release_day": null,
    "original_format": "mp3",
    "license": "cc-by",
    "uri": "https://api.soundcloud.com/tracks/12766372",
    "user":  {
      "id": 727717,
      "kind": "user",
      "permalink": "the-midwess",
      "username": "THE MIDWESS",
      "last_modified": "2015/02/21 03:25:36 +0000",
      "uri": "https://api.soundcloud.com/users/727717",
      "permalink_url": "http://soundcloud.com/the-midwess",
      "avatar_url": "https://i1.sndcdn.com/avatars-000004995472-g8c72d-large.jpg"
    },
    "permalink_url": "http://soundcloud.com/the-midwess/phase-v-4-0",
    "artwork_url": "https://i1.sndcdn.com/artworks-000005962896-0l1jp8-large.jpg",
    "waveform_url": "https://w1.sndcdn.com/VbrzqYHVt4tV_m.png",
    "stream_url": "https://api.soundcloud.com/tracks/12766372/stream",
    "playback_count": 9557,
    "download_count": 100,
    "favoritings_count": 349,
    "comment_count": 124,
    "attachments_uri": "https://api.soundcloud.com/tracks/12766372/attachments",
    "policy": "ALLOW"
  },{
    "kind": "track",
    "id": 16340931,
    "created_at": "2011/06/01 17:53:42 +0000",
    "user_id": 28645,
    "duration": 15782,
    "commentable": true,
    "state": "finished",
    "original_content_size": 195009,
    "last_modified": "2013/03/26 02:39:26 +0000",
    "sharing": "public",
    "tag_list": "soundcloud:source=android-record",
    "permalink": "next-stop-union-square-at",
    "streamable": true,
    "embeddable_by": "all",
    "downloadable": false,
    "purchase_url": null,
    "label_id": null,
    "purchase_title": null,
    "genre": null,
    "title": "Next stop",
    "description": null,
    "label_name": null,
    "release": null,
    "track_type": "recording",
    "key_signature": null,
    "isrc": null,
    "video_url": null,
    "bpm": null,
    "release_year": null,
    "release_month": null,
    "release_day": null,
    "original_format": "m4a",
    "license": "all-rights-reserved",
    "uri": "https://api.soundcloud.com/tracks/16340931",
    "user":  {
      "id": 28645,
      "kind": "user",
      "permalink": "fredwilson",
      "username": "fredwilson",
      "last_modified": "2015/02/09 23:38:52 +0000",
      "uri": "https://api.soundcloud.com/users/28645",
      "permalink_url": "http://soundcloud.com/fredwilson",
      "avatar_url": "https://i1.sndcdn.com/avatars-000000124660-wif96w-large.jpg"
    },
    "created_with":  {
      "id": 3152,
      "kind": "app",
      "name": "SoundCloud Android",
      "uri": "https://api.soundcloud.com/apps/3152",
      "permalink_url": "http://soundcloud.com/apps/android",
      "external_url": "https://market.android.com/details?id=com.soundcloud.android"
    },
    "permalink_url": "http://soundcloud.com/fredwilson/next-stop-union-square-at",
    "artwork_url": "https://i1.sndcdn.com/artworks-000007816778-x9fb05-large.jpg",
    "waveform_url": "https://w1.sndcdn.com/iBeuZTlHYLZZ_m.png",
    "stream_url": "https://api.soundcloud.com/tracks/16340931/stream",
    "playback_count": 5026,
    "download_count": 0,
    "favoritings_count": 29,
    "comment_count": 12,
    "attachments_uri": "https://api.soundcloud.com/tracks/16340931/attachments",
    "policy": "ALLOW"
  }
]

var titles = []; 
var imageurls = []; 
for(var i = 0; i < stuff.length; i++){
    titles[i] = stuff[i].title; 
    imageurls[i] = stuff[i].artwork_url;
} 

            // As in previous steps, we create a basic structure of a graph:
            var graph = Viva.Graph.graph(); 
            graph.addNode('user', {url : 'http://www.localcrimenews.com/wp-content/uploads/2013/07/default-user-icon-profile.png'}); 
            for(var i = 0;i < titles.length; i++){
                graph.addNode(titles[i], {url : imageurls[i]});
                graph.addLink('user', titles[i], {connectionStrength: 0.1}); 
            }
            
           
           
            
            
           
            var graphics = Viva.Graph.View.svgGraphics(),
                nodeSize = 48,
                // we use this method to highlight all realted links
                // when user hovers mouse over a node:
                highlightRelatedNodes = function(nodeId, isOn) {
                   // just enumerate all realted nodes and update link color:
                   graph.forEachLinkedNode(nodeId, function(node, link){
                       var linkUI = graphics.getLinkUI(link.id);
                       if (linkUI) {
                           // linkUI is a UI object created by graphics below
                           linkUI.attr('stroke', isOn ? 'red' : 'gray');
                       }
                   });
                };

            // Since we are using SVG we can easily subscribe to any supported
            // events (http://www.w3.org/TR/SVG/interact.html#SVGEvents ),
            // including mouse events:
            var graphics = Viva.Graph.View.svgGraphics();
                graphics.node(function(node) {
                    // The function is called every time renderer needs a ui to display node
                    return Viva.Graph.svg('image')
                    .attr('width', 50)
                    .attr('height', 50)
                    .link(node.data.url); // node.data holds custom object passed to graph.addNode();
                    })
                    .placeNode(function(nodeUI, pos){
                    // Shift image to let links go to the center:
                    nodeUI.attr('x', pos.x - 25).attr('y', pos.y - 25);
                    });
            
          
             var idealLength = 180;
              var layout = Viva.Graph.Layout.forceDirected(graph, {
                  springLength: idealLength,
                  springCoeff : 0.0008,
                  gravity : -10,
                  // This is the main part of this example. We are telling force directed
                  // layout, that we want to change length of each physical spring
                  // by overriding `springTransform` method:
                  springTransform: function (link, spring) {
                    spring.length = idealLength * (1 - link.data.connectionStrength);
                  }
              });
             
            
           
            
            // Finally render the graph with our customized graphics object:
           
              var renderer = Viva.Graph.View.renderer(graph, {
                  graphics : graphics}, {
                  layout : layout
              });
            renderer.run();
        }
    </script>

    <style type="text/css" media="screen">
        html,body, svg {
                height: 100%;
                width: 100%;
                position: absolute;
                margin: 0;
            }
    </style>
</head>
<body onload='main()'>

</body>
</html>
